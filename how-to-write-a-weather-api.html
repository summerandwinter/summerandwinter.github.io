<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>根据中国气象局提供的API接口实现天气查询 | Winter`s Notes</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="canonical" href="https://summerandwinter.github.io/how-to-write-a-weather-api.html"><meta name="description" content="利用中国气象局提供的接口实现天气查询，该接口已失效。"><meta name="keywords" content="API,中国气象局,天气查询"><meta property="og:type" content="article"><meta property="og:title" content="根据中国气象局提供的API接口实现天气查询"><meta property="og:url" content="https://summerandwinter.github.io/how-to-write-a-weather-api.html"><meta property="og:site_name" content="Winter`s Notes"><meta property="og:description" content="利用中国气象局提供的接口实现天气查询，该接口已失效。"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2019-11-28T08:58:49.415Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="根据中国气象局提供的API接口实现天气查询"><meta name="twitter:description" content="利用中国气象局提供的接口实现天气查询，该接口已失效。"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/summerandwinter/summerandwinter.github.io/css/gitment.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/summerandwinter/summerandwinter.github.io/css/article.css"></head></html><body><div id="container"><div id="wrap"><header id="header" class="header"><nav id="main-nav" class="main-nav"> <a class="main-nav-link" href="/">主页</a> <a class="main-nav-link" href="/archives">归档</a> <a class="main-nav-link" href="/category">分类</a> <a class="main-nav-link" href="/tag">标签</a></nav><nav id="sub-nav"></nav></header><div class="outer"><section id="main"><div class="article-container"><article id="post-how-to-write-a-weather-api" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name"> 根据中国气象局提供的API接口实现天气查询</h1></header><div class="article-entry typo" itemprop="articleBody"><p><strong>中国气象局提供了三个天气查询的API接口：</strong></p><p>【1】<a href="http://www.weather.com.cn/data/sk/**101190101**.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/sk/**101190101**.html</a></p><p>【2】<a href="http://www.weather.com.cn/data/cityinfo/**101190101**.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/cityinfo/**101190101**.html</a></p><p>【3】<a href="http://m.weather.com.cn/data/**101190101**.html" target="_blank" rel="noopener">http://m.weather.com.cn/data/**101190101**.html</a></p><p>以json格式返回数据，第一和第二个接口返回当天实时的天气数据，第三个返回未来五天天气情况。</p><p>其中地址里的加粗显示的数字表示城市的代码：101190101 代表南京（获取城市代码的方法下面会说明）</p><p>第三个接口的返回数据示例及说明如下：</p><a id="more"></a><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	weatherinfo: &#123;</span><br><span class="line">		city: “南京”,</span><br><span class="line">		city_en: “nanjing”,</span><br><span class="line">		date_y: “2013年9月8日”,</span><br><span class="line">		date: “”,</span><br><span class="line">		week: “星期日”,</span><br><span class="line">		fchh: “18”,</span><br><span class="line">		cityid: “101190101”, //城市代码</span><br><span class="line">		temp1: “22℃~30℃”, //第一天（当天）最高喝最低温度（摄氏温度）</span><br><span class="line">		temp2: “23℃~29℃”, //第二天最高喝最低温度（摄氏温度）</span><br><span class="line">		temp3: “22℃~28℃”, //第三天最高喝最低温度（摄氏温度）</span><br><span class="line">		temp4: “23℃~30℃”, //第四天最高喝最低温度（摄氏温度）</span><br><span class="line">		temp5: “24℃~28℃”, //第五天最高喝最低温度（摄氏温度）</span><br><span class="line">		temp6: “23℃~28℃”, //第六天最高喝最低温度（摄氏温度）</span><br><span class="line">		tempF1: “71.6℉~86℉”, //第一天（当天）最高喝最低温度（华氏温度）</span><br><span class="line">		tempF2: “73.4℉~84.2℉”, //第二天最高喝最低温度（华氏温度）</span><br><span class="line">		tempF3: “71.6℉~82.4℉”, //第三天最高喝最低温度（华氏温度）</span><br><span class="line">		tempF4: “73.4℉~86℉”, //第四天最高喝最低温度（华氏温度）</span><br><span class="line">		tempF5: “75.2℉~82.4℉”, //第五天最高喝最低温度（华氏温度）</span><br><span class="line">		tempF6: “73.4℉~82.4℉”, //第六天最高喝最低温度（华氏温度）</span><br><span class="line">		weather1: “多云转阴”, //第一天（当天）天气</span><br><span class="line">		weather2: “小雨”, //第二天天气</span><br><span class="line">		weather3: “小雨”,</span><br><span class="line">		weather4: “阴”,</span><br><span class="line">		weather5: “小雨转中雨”,</span><br><span class="line">		weather6: “中雨转阴”,</span><br><span class="line">		img1: “1”, //第一天的天气图片代码1</span><br><span class="line">		img2: “2”, //第一天的天气图片代码2</span><br><span class="line">		img3: “7”, //第二天的天气图片代码1</span><br><span class="line">		img4: “99”, //第二天的天气图片代码2</span><br><span class="line">		img5: “7”,</span><br><span class="line">		img6: “99”,</span><br><span class="line">		img7: “2”,</span><br><span class="line">		img8: “99”,</span><br><span class="line">		img9: “7”,</span><br><span class="line">		img10: “8”,</span><br><span class="line">		img11: “8”,</span><br><span class="line">		img12: “2”,</span><br><span class="line">		img_single: “2”</span><br><span class="line">		img_title1: “多云”, //第一天的天气图片1的标题</span><br><span class="line">		img_title2: “阴”, //第一天的天气图片2的标题</span><br><span class="line">		img_title3: “小雨”, //第二天的天气图片1的标题</span><br><span class="line">		img_title4: “小雨”, //第二天的天气图片2的标题</span><br><span class="line">		img_title5: “小雨”,</span><br><span class="line">		img_title6: “小雨”,</span><br><span class="line">		img_title7: “阴”,</span><br><span class="line">		img_title8: “阴”,</span><br><span class="line">		img_title9: “小雨”,</span><br><span class="line">		img_title10: “中雨”,</span><br><span class="line">		img_title11: “中雨”,</span><br><span class="line">		img_title12: “阴”,</span><br><span class="line">		img_title_single: “阴”,</span><br><span class="line">		wind1: “东风3-4级”, //第一天风向范围</span><br><span class="line">		wind2: “东风3-4级”, //第二天风向范围</span><br><span class="line">		wind3: “北风转东北风3-4级”,</span><br><span class="line">		wind4: “东北风3-4级”,</span><br><span class="line">		wind5: “东北风转西风3-4级”,</span><br><span class="line">		wind6: “西南风转西风3-4级”,</span><br><span class="line">		fx1: “东风”,</span><br><span class="line">		fx2: “东风”,</span><br><span class="line">		fl1: “3-4级”, //第一天风级范围</span><br><span class="line">		fl2: “3-4级”,</span><br><span class="line">		fl3: “3-4级”,</span><br><span class="line">		fl4: “3-4级”,</span><br><span class="line">		fl5: “3-4级”,</span><br><span class="line">		fl6: “3-4级”,</span><br><span class="line">		index: “热”, //二十四小时穿衣指数</span><br><span class="line">		index_d: “天气热，建议着短裙、短裤、短薄外套、T恤等夏季服装。”, //建议</span><br><span class="line">		index48: “热”, //四十八小时穿衣指数</span><br><span class="line">		index48_d: “天气热，建议着短裙、短裤、短薄外套、T恤等夏季服装。”, //建议</span><br><span class="line">		index_uv: “弱”, //二十四小时紫外线</span><br><span class="line">		index48_uv: “弱”, //四十八小时紫外线</span><br><span class="line">		index_xc: “不宜”, //洗车</span><br><span class="line">		index_tr: “适宜”, //旅游</span><br><span class="line">		index_co: “较舒适”, //舒适度</span><br><span class="line">		st1: “30”,</span><br><span class="line">		st2: “20”,</span><br><span class="line">		st3: “27”,</span><br><span class="line">		st4: “19”,</span><br><span class="line">		st5: “26”,</span><br><span class="line">		st6: “18”,</span><br><span class="line">		index_cl: “较适宜”, //晨练</span><br><span class="line">		index_ls: “不太适宜”, //晾晒</span><br><span class="line">		index_ag: “极易发” //过敏</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>获取城市代码的方法：</p><p><strong>1.首先获取省份列表</strong></p><p><a href="http://www.weather.com.cn/data/city3jdata/china.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/city3jdata/china.html</a></p><p>这个链接以json格式返回一个包含省份代码和省份名称的数组<br></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123; </span><br><span class="line">	10101: “北京”, </span><br><span class="line">	10102: “上海”, </span><br><span class="line">	…. ,</span><br><span class="line">	10119: “江苏”,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>2.通过上面获得的省份代码获取城市列表：</strong></p><p>如江苏的城市代码为：10119，通过下面的链接可以获得江苏省的城市列表</p><p><a href="http://www.weather.com.cn/data/city3jdata/provshi/10119.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/city3jdata/provshi/10119.html</a><br></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	10: “连云港”,</span><br><span class="line">	11: “常州”,</span><br><span class="line">	…</span><br><span class="line">	01: “南京”,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>3.获取城市下的区域信息</strong></p><p>通过上一步可获取城市代码 如：南京为 01</p><p>把01接到第一步获得的省份代码后 获得 <strong>1011901</strong> 代表江苏省南京市</p><p>通过下面的链接可获取江苏省南京市的区域信息，加粗部分为刚刚生成的代码</p><p><a href="http://www.weather.com.cn/data/city3jdata/station/**1011901**.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/city3jdata/station/**1011901**.html</a><br></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	01: “南京”,</span><br><span class="line">	02: “溧水”,</span><br><span class="line">	03: “高淳”,</span><br><span class="line">	04: “江宁”,</span><br><span class="line">	05: “六合”,</span><br><span class="line">	06: “江浦”,</span><br><span class="line">	07: “浦口”</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>4.获取区域代码</strong></p><p>把上面获得的区域代码如：<strong>01</strong>（代表南京市区） 接到第三步获得的江苏省南京市的代码 <strong>1011901</strong></p><p>得到 <strong>101190101</strong> 代表江苏省南京市南京市区的代码。</p><p>这串代码就是我们需要的。</p><p><a href="http://m.weather.com.cn/data/**101190101**.html" target="_blank" rel="noopener">http://m.weather.com.cn/data/**101190101**.html</a></p><p>放到这个链接里我们就能获得江苏省南京市南京市区的天气信息啦！</p><div class="end-of-file">END</div></div><footer class="article-footer"><ul class="article-meta"><li> <span class="label">发布:</span> <a href="/how-to-write-a-weather-api.html" class="article-date"><time datetime="2013-09-08T20:33:09.000Z" itemprop="datePublished">2013-09-08</time></a></li><li> <span class="label">分类:</span><div class="article-category"> <a class="article-category-link" href="/category/PHP/">PHP</a></div></li><li> <span class="label">标签:</span><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/API/">API</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/中国气象局/">中国气象局</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/天气查询/">天气查询</a></li></ul></li><hr></ul></footer></div><nav id="article-nav" class="article-nav"> <a href="/how-to-write-a-train-api.html" id="article-nav-newer" class="article-nav-link-wrap newer"><strong class="article-nav-caption">上一篇</strong><div class="article-nav-title"> 火车查询API接口</div></a> <a href="/wordpress-add-local-head.html" id="article-nav-older" class="article-nav-link-wrap older"><strong class="article-nav-caption">下一篇</strong><div class="article-nav-title">WordPress添加自定义默认本地头像</div></a></nav></article><section id="gitment_ccomments" class="comments"><div id="gitment_container"></div></section></div></section></div><footer id="footer" class="post-footer footer"><div id="footerContent" class="footer-content"><div class="end-of-file">Live Happy Love Hard</div></div></footer></div><script src="//cdn.jsdelivr.net/gh/summerandwinter/summerandwinter.github.io/js/gitment.js"></script><script>var date="Sun Sep 08 2013 20:33:09 GMT+0000",id=""+new Date(date).getTime(),gitment=new Gitment({id:id,owner:"summerandwinter",repo:"summerandwinter.github.io",oauth:{client_id:"7b432b7b46e71966fd88",client_secret:"2c697bec7b012bca975de41c87863d84086f8d81"}});gitment.render("gitment_container")</script><script src="//cdn.jsdelivr.net/gh/summerandwinter/summerandwinter.github.io/js/summer.js"></script><!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]--></div></body>