<html><head><script>window.onload=function(){var a=document.getElementById("myCanvas"),t=document.getElementById("imageSource");a.width=t.width,a.height=t.height;var d=a.getContext("2d");d.drawImage(t,0,0);for(var e=d.getImageData(0,0,a.width,a.height),h=63.75,i=1,g=32768*(i*=i)+1,n=0;n<e.width;n++)for(var o=0;o<e.height;o++){var m,r,w,v=4*(n+o*e.width),u=e.data[v+0],I=e.data[v+1],c=e.data[v+2];if(u=255<(m=u+h)?255:m<0?0:m,I=255<(r=I+h)?255:r<0?0:r,c=255<(w=c+h)?255:w<0?0:w,32769!=g)m=(m=u-128)*g>>15,r=(r=I-128)*g>>15,w=(w=c-128)*g>>15,u=255<(m+=128)?255:m<0?0:m,I=255<(r+=128)?255:r<0?0:r,c=255<(w+=128)?255:w<0?0:w;e.data[v+0]=u,e.data[v+1]=I,e.data[v+2]=c,e.data[v+3]=255}d.putImageData(e,0,0)}</script></head><body><p>原图</p> <img id="imageSource" src="original.jpg" alt="Canvas Source"><p>效果图</p><canvas id="myCanvas">Gray Filter</canvas></body></html>