<html><head><script>fclamp0255=function(a){return 255<a?255:a<0?0:a},window.onload=function(){var w=document.getElementById("myCanvas"),c=w.getContext("2d"),l=new Image;l.src="original.jpg",l.onload=function(){w.width=l.width,w.height=l.height,c.drawImage(l,0,0);var a=c.getImageData(0,0,w.width,w.height),t=new Array;t=[0,1,0,2,1,2,1,0,2,0,2,1];for(var d=[2,1,3,5],e=[6,3,3,15],i=0;i<a.width;i++)for(var n=0;n<a.height;n++){var r=4*(i+n*a.width),g=a.data[r+0],h=a.data[r+1],o=a.data[r+2],f=d[0],m=f*(n%e[0])+i%f;if(0==(m=t[m]))g=fclamp0255(2*g);if(1==m)h=fclamp0255(2*h);if(2==m)o=fclamp0255(2*o);a.data[r+0]=g,a.data[r+1]=h,a.data[r+2]=o,a.data[r+3]=255}c.putImageData(a,0,0)}}</script></head><p>原图</p> <img src="original.jpg"><p>效果图</p><canvas id="myCanvas">Gray Filter</canvas><canvas id="cv">Gray Filter</canvas></html>