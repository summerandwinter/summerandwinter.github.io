define(function(e,t,n){var i=e("common"),o=function(){$.extendGetJSON(i.httpURL+$("#url>#GetConfig").val(),{moduleId:100100,isGetScreenState:"True"},function(e){$("#screenfinished").remove(),5!=e.State&&$("body").append('<div id="screenfinished"><span>活动已结束</span></div>'),$("body").data("screenConfig",e.Configs),setTimeout(function(){o()},3e4)},function(){setTimeout(function(){o()},3e4)})},c=function(){$("#main>#materiel").size()<1&&$("#main").append('<div id="materiel"></div>'),$("#main>#materiel").html(""),$.extendGetJSON(i.httpURL+$("#url>#GetAd").val(),{moduleId:$("#config>#KXDPMModuleId").val()},function(e){e&&0<e.length&&$(e).each(function(e,t){if(2==t.type)switch(t.showType){case 1:$("#main>#materiel").append('<img data-id="'+t.id+'" class="materiel-left" src="'+$("#config>#FileWebHost").val()+t.imgUrl+'" />');break;case 3:$("#main>#materiel").append('<img data-id="'+t.id+'" class="materiel-top" src="'+$("#config>#FileWebHost").val()+t.imgUrl+'" />');break;case 5:$("#main>#materiel").append('<img data-id="'+t.id+'" class="materiel-right" src="'+$("#config>#FileWebHost").val()+t.imgUrl+'" />')}}),setTimeout(function(){c()},6e4)},function(){setTimeout(function(){c()},6e4)})},a=function(){$("#main>#materiel img[data-id]").each(function(e,t){$.extendPost(i.httpURL+$("#url>#SubmitAdAccessLog").val(),{id:$(t).data("id"),operationType:3,showTimeLength:60},"text",function(){})}),setTimeout(function(){a()},6e4)},l=function(e){$.extendPost(i.httpURL+$("#url>#SubmitNetworkInterruptAndRecoveryLog").val(),{time:e},"text",function(){},function(){setTimeout(function(){l(e)},6e4)})},s=function(){$(window).width()/$(window).height()<1.7777?$("body").css("background-size","auto 100%"):$("body").css("background-size","100% auto")};t.init=function(){$("#wall_zz").size()<1&&(s(),$(window).resize(function(){s()})),-1!==window.navigator.userAgent.indexOf("Chrome")||$("body").prepend('<div id="nohtml5"><div>由于您正在使用非chrome浏览器,大屏幕的体验处于不佳状态,建议您立刻更换浏览器,以获得更好的大屏幕产品用户体验。<br/>下载浏览器:<a href="http://www.chromeliulanqi.com/" target="blank"><img src=" '+$("#config>#FileWebHost").val()+'/ScreenTheme/default/images/chrome.jpg"> chrome浏览器</a></div></div>'),$(".select").click(function(e){e.stopPropagation(),$(this).parent().hasClass("disabled")||($(".select_option").slideUp(),"none"==$(this).next(".select_option").css("display")?($(this).next(".select_option").css({left:$(this).position().left,top:$(this).position().top+35}),$(this).next(".select_option").slideDown("fast")):$(this).next(".select_option").slideUp()),$(document).bind("click",function(){$(".select_option").slideUp()})}),o(),$("#index>#code>a.clickBtn").on("click",function(){$("#index").remove(),c(),a(),$(".moduleBtn").each(function(e,t){$("#btn_change").append($(t).html())}),$(".moduleBtn").remove(),$("#btn_change").append('<li class="btn_qrcode" data-name="qrcode" data-description="二维码"><i class="iconfont">&#xe621;</i></li>'),$('#btn_change>li:not([data-name="messagewalldanmu"])').on("click",function(){var e=$(this);$("body").triggerHandler("modulechange",[e.data("name")])}),$("#btn_change").append('<li class="btn_NetworkStatus" data-description="网络状态" id="NetworkStatus"><i class="iconfont">&#xe625;</i></li><li class="btn_fullscreen" data-description="全屏 F11" id="fullscreen"><i class="iconfont">&#xe603;</i></li><li class="btn_hidden" data-description="隐藏/显示" id="hideBtn"><i class="iconfont">&#xe62d;</i></li>'),setInterval(function(){var e=$("<img />");e.attr({src:"http://www.baidu.com/img/bdlogo.gif?_r="+Math.random(),id:"testConnectionStatus"}).css("display","none"),e.on("load",function(){$("#NetworkStatus i").html("&#xe625;");var e=localStorage.getItem("networkInterruptTime");e&&(l(e),localStorage.removeItem("networkInterruptTime"))}).on("error",function(){if($("#NetworkStatus i").html("&#xe626;"),!localStorage.getItem("networkInterruptTime")){var e=new Date;localStorage.setItem("networkInterruptTime",e.getFullYear()+"-"+i.fillZero(e.getMonth()+1,2)+"-"+i.fillZero(e.getDate(),2)+" "+i.fillZero(e.getHours(),2)+":"+i.fillZero(e.getMinutes(),2)+":"+i.fillZero(e.getSeconds(),2))}})},5e3),$("#hideBtn").click(function(){$(this).hasClass("btn_hidden")?($(this).find("i").html("&#xe62c;"),$("#btn_change").animate({left:46-$("#btn_change").width()}),$(this).removeClass("btn_hidden")):($("#btn_change").animate({left:0}),$(this).addClass("btn_hidden"),$(this).find("i").html("&#xe62d;"))});var t=!1;$("#btn_change>li.btn_fullscreen").on("click",function(){if(t)document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),t=!1;else{var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen(),t=!0}}),$("#activityCode>#top_code").on("click",function(){$("body").triggerHandler("modulechange",["qrcode"])}),$("#activityCode>#showCode>a.closeBtn").on("click",function(){$("body").triggerHandler("modulechange",[$("#btn_change>li:not(.btn_fullscreen):eq(0)").data("name")])}),$("#btn_change>li").hover(function(){i.showTips(this)},function(){i.removeTips()}),$("#btn_change").show(),$("body").triggerHandler("active"),$("body").triggerHandler("modulechange",[$("#btn_change>li:not(.btn_fullscreen):eq(0)").data("name")])}),$("body").on("modulechange",function(e,t){"qrcode"!=t?$("#activityCode>#showCode").hide():$("#activityCode>#showCode").show()})}});